import{A as S,a as l,b as d,ga as m,i as D}from"./chunk-4LOCN6XP.js";var v=[{value:"green",label:"Green",class:"bg-standby-accent-green"},{value:"blue",label:"Blue",class:"bg-standby-accent-blue"},{value:"orange",label:"Orange",class:"bg-standby-accent-orange"},{value:"yellow",label:"Yellow",class:"bg-standby-accent-yellow"},{value:"teal",label:"Teal",class:"bg-standby-accent-teal"}],T=[{value:"Low",label:"Low"},{value:"Medium",label:"Medium"},{value:"High",label:"High"}],y=["Small steps, every day.","Don't break the chain.","Your future is built today.","Consistency beats intensity.","Show up. That's the win.","Progress, not perfection.","One day at a time.","Build the habit, become the person.","Your discipline is your freedom.","Trust the process.","Every day is a fresh start.","Momentum starts with one step."];var f=class p{STORAGE_KEY="standby_habits";habitsSignal=S(this.loadFromStorage());habits=this.habitsSignal.asReadonly();totalHabits=m(()=>this.habitsSignal().length);habitsCompletedToday=m(()=>{let t=this.formatDate(new Date);return this.habitsSignal().filter(e=>e.completions[t]).length});totalCurrentStreak=m(()=>{let t=this.habitsSignal();return t.length===0?0:Math.max(...t.map(e=>this.calculateStats(e).currentStreak))});constructor(){}loadFromStorage(){try{let t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t):[]}catch{return[]}}saveToStorage(){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(this.habitsSignal()))}generateId(){return`habit_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}formatDate(t){let e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${a}`}parseDate(t){let[e,n,a]=t.split("-").map(Number);return new Date(e,n-1,a)}createHabit(t){let e=new Date().toISOString(),n=d(l({},t),{id:this.generateId(),completions:{},createdAt:e,updatedAt:e});return this.habitsSignal.update(a=>[...a,n]),this.saveToStorage(),n}updateHabit(t,e){let n=null;return this.habitsSignal.update(a=>a.map(o=>o.id===t?(n=d(l(l({},o),e),{updatedAt:new Date().toISOString()}),n):o)),this.saveToStorage(),n}deleteHabit(t){this.habitsSignal.update(e=>e.filter(n=>n.id!==t)),this.saveToStorage()}getHabitById(t){return this.habitsSignal().find(e=>e.id===t)}toggleCompletion(t,e){this.habitsSignal.update(n=>n.map(a=>{if(a.id===t){let o=l({},a.completions);return o[e]?delete o[e]:o[e]=!0,d(l({},a),{completions:o,updatedAt:new Date().toISOString()})}return a})),this.saveToStorage()}markTodayCompleted(t){let e=this.formatDate(new Date);this.habitsSignal.update(n=>n.map(a=>a.id===t&&!a.completions[e]?d(l({},a),{completions:d(l({},a.completions),{[e]:!0}),updatedAt:new Date().toISOString()}):a)),this.saveToStorage()}isCompletedToday(t){let e=this.formatDate(new Date),n=this.getHabitById(t);return n?!!n.completions[e]:!1}calculateStats(t){let e=this.parseDate(t.startDate),n=this.parseDate(t.endDate),a=new Date;a.setHours(0,0,0,0);let o=n<a?n:a,s=0,r=0,i=0,g=0,u=0,b=new Date(e);for(;b<=o;){s++;let h=this.formatDate(b);t.completions[h]?(r++,u++,g=Math.max(g,u)):u=0,b.setDate(b.getDate()+1)}i=0;let c=new Date(a),w=this.formatDate(a);for(t.completions[w]||c.setDate(c.getDate()-1);c>=e;){let h=this.formatDate(c);if(t.completions[h])i++,c.setDate(c.getDate()-1);else break}let H=s>0?r/s*100:0;return{totalDays:s,completedDays:r,currentStreak:i,longestStreak:g,completionRate:H}}getProgressPercentage(t){let e=this.calculateStats(t);return Math.round(e.completionRate)}getDailyMotivation(){let t=new Date,e=Math.floor((t.getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5);return y[e%y.length]}getCompletionGridData(t,e=12){let n=[],a=new Date;a.setHours(0,0,0,0);let o=this.formatDate(a),s=new Date(a);s.setDate(s.getDate()-(e*7-1));let r=new Date(s);for(;r<=a;){let i=this.formatDate(r);n.push({date:i,completed:!!t.completions[i],isToday:i===o,isFuture:r>a}),r.setDate(r.getDate()+1)}return n}getGlobalCompletionGrid(t=12){let e=[],n=this.habitsSignal(),a=new Date;a.setHours(0,0,0,0);let o=this.formatDate(a),s=new Date(a);s.setDate(s.getDate()-(t*7-1));let r=new Date(s);for(;r<=a;){let i=this.formatDate(r),g=n.filter(u=>u.completions[i]).length;e.push({date:i,count:g,isToday:i===o}),r.setDate(r.getDate()+1)}return e}getColorClass(t){return{green:"bg-standby-accent-green",blue:"bg-standby-accent-blue",orange:"bg-standby-accent-orange",yellow:"bg-standby-accent-yellow",teal:"bg-standby-accent-teal"}[t]||"bg-standby-accent-green"}static \u0275fac=function(e){return new(e||p)};static \u0275prov=D({token:p,factory:p.\u0275fac,providedIn:"root"})};export{v as a,T as b,f as c};
